<html>

<head>
	<title>d3Vienno</title>
	<script type="text/javascript" src="d3.min.js"></script>
	<script type="text/javascript">
	  function GetUrlValue(VarSearch){
	  var SearchString = window.location.search.substring(1);
	  console.log(SearchString);
	  var VariableArray = SearchString.split('&');
	  console.log(VariableArray);
	  for(var i = 0; i < VariableArray.length; i++){
	    var KeyValuePair = VariableArray[i].split('=');
	    if(KeyValuePair[0] == VarSearch){
	      console.log(KeyValuePair[1]);
	      return KeyValuePair[1];
	      }
	    }
	  }



</script>

</head>


<body>

<script>
	
	//var data = [10,20,7,4,6,1,3,3,6];
	var r = 180;

	var color = d3.scale.category20();
	file = GetUrlValue("district");


	d3.json(file + ".json", function(data){

	var canvas = d3.select("body").append("svg").attr("width", "100%").attr("height","100%");
		

		var group = canvas.append("g") 
			.attr("transform" , "translate(300,300)");

		
		var arc = d3.svg.arc()
					.innerRadius(120)
					.outerRadius(r);

		var pie = d3.layout.pie()
					.value(function (d){console.log(d); return d.TOV_Cases;});
					//.sort(null);

		var arcs = group.selectAll(".arc")
						.data(pie(data))
						.enter()
						.append("g")
						.attr("class", "arcs");

		/*arcs.append("text")
			  //.attr("dy", "0")
			  .style("text-anchor", "middle")
			  .text(function(d) { return "TOV"; });
*/
		arcs.append("path")
			.attr("d", arc)
			.attr("fill", function(d,i){return color(i);})
			.on("mouseenter", function(d,i) {
                  text = arcs.append("text")
                  .attr("transform", arc.centroid(d))
                  .attr("dy", ".5em")
                  .style("text-anchor", "middle")
                  .style("font-size","20px")
                  .style("fill", "darkgrey")
                  .attr("class", "on")
                  .text(d.data.TOV+":"+d.data.TOV_Cases);
		      })

		      .on("mouseout", function(d) {
		               text.remove();
		      })
		      .append("title")
					.text(function(d) {return d.data.TOV + ":" + d.data.TOV_Cases;});

		

		/*arcs.append("text")
			.attr("transform", function(d){ return "translate(" + arc.centroid(d) + ")";})
			.text(function (d) {return d.data.TOV_Cases;});
*/
	});

		/**arcs.transition()
			.duration(1000)
			.delay(300)
			.attr('r',10)
			.each("start",function() { d3.select{this}; });
			**/

			</script>

</body>

<html>